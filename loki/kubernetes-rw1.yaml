groups:
- name: "KubernetesRW1"
  rules:

  # Alert non-healthy pods as critical (except the ones that were evicted)
  - alert: KubernetesPodNotHealthy
    expr: |
      (sum by (namespace, pod, phase) (kube_pod_status_phase{phase=~"Pending|Unknown|Failed"}) > 0)
      * on (namespace, pod) group_left(reason) (kube_pod_status_reason{reason!="Evicted"} > 0)
    for: 0m
    labels:
      severity: critical
      category: service
    annotations:
      summary: Kubernetes Pod not healthy
      description: "Pod saf has been in asf state (reason gfsg) for longer than 15 minutes."
      action: "Investigate the reason for the failed pod, check pod status and logs. Resolve the issue and restart the affected pod."

  # Alert evicted pods as warning
  - alert: KubernetesPodEvicted
    expr: |
      (sum by (namespace, pod, phase) (kube_pod_status_phase{phase=~"Pending|Unknown|Failed"}) > 0)
      * on (namespace, pod) (kube_pod_status_reason{reason="Evicted"} > 0)
    for: 0m
    labels:
      severity: warning
      category: service
    annotations:
      summary: Kubernetes Pod evicted
      description: "Pod was evicted."
      action: "A certain number of evicted pods can be tolerated. If there are hundreds of evicted pods, consider manually deleting them to free resources."
